% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/c_wrappers.R
\name{gnps_compute_wrapper}
\alias{gnps_compute_wrapper}
\title{Wrapper for the C function "gnps_compute"}
\usage{
gnps_compute_wrapper(x, y, xPrecursorMz, yPrecursorMz, tolerance, ppm)
}
\arguments{
\item{x}{Numeric matrix with query spectrum peaks (mz, intensity).}

\item{y}{Numeric matrix with target spectrum peaks (mz, intensity).}

\item{xPrecursorMz}{Numeric precursor m/z for query spectrum}

\item{yPrecursorMz}{Numeric precursor m/z for target spectrum}

\item{tolerance}{Numeric value specifying the absolute tolerance in Daltons}

\item{ppm}{Numeric value specifying the relative tolerance in ppm}
}
\value{
A list with two integer vectors:
\item{indices_x}{Indices of matched peaks in x}
\item{indices_y}{Indices of matched peaks in y}
}
\description{
Fused GNPS join + score in a single C call. Performs
peak matching and scoring internally without R-level allocation.
Uses chain-DP optimal assignment (O(n+m) time).

\if{html}{\out{<div class="sourceCode">}}\preformatted{**Spectra must be sanitized** before calling this function:
unique m/z values (no duplicates within tolerance), sorted by m/z,
no NaN/NA. This is guaranteed by [sanitize_spectra()] via
[import_spectra()]. See [sanitize_spectrum_matrix()] for a
lightweight fallback.
}\if{html}{\out{</div>}}
}
\examples{
\dontrun{
query_mz <- c(100.05, 200.10, 300.15)
target_mz <- c(100.06, 200.11, 400.20)
matches <- join_gnps_wrapper(
  x = query_mz,
  y = target_mz,
  xPrecursorMz = 500.0,
  yPrecursorMz = 500.0,
  tolerance = 0.01,
  ppm = 10
)
}
}
\keyword{internal}
