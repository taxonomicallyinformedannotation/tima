% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sanitize_spectrum_matrix.R
\name{sanitize_spectrum_matrix}
\alias{sanitize_spectrum_matrix}
\title{Sanitize a spectrum matrix for C-level scoring}
\usage{
sanitize_spectrum_matrix(spectrum, tolerance = 0.01, ppm = 10)
}
\arguments{
\item{spectrum}{Numeric matrix with at least 2 columns (mz, intensity)}

\item{tolerance}{Numeric absolute tolerance in Daltons (default: 0.01)}

\item{ppm}{Numeric relative tolerance in ppm (default: 10)}
}
\value{
A sanitized numeric matrix with columns mz and intensity.
May have fewer rows than input. Returns a 0-row matrix if all
peaks are removed.
}
\description{
Lightweight sanitization of a peak matrix (mz, intensity)
to meet the requirements of the GNPS C scoring functions. This is a
fallback for spectra that were not pre-processed via
\code{\link[=sanitize_spectra]{sanitize_spectra()}} / \code{\link[=import_spectra]{import_spectra()}}.

\if{html}{\out{<div class="sourceCode">}}\preformatted{Operations performed:
\\enumerate\{
  \\item Remove rows with NaN or NA values
  \\item Sort by m/z
  \\item Merge peaks within tolerance (intensity-weighted mean m/z,
        summed intensity)
\}
}\if{html}{\out{</div>}}
}
\keyword{internal}
