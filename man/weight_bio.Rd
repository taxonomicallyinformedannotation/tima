% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weight_bio.R
\name{weight_bio}
\alias{weight_bio}
\title{Weight annotations by biological source}
\usage{
weight_bio(
  annotation_table_taxed,
  structure_organism_pairs_table,
  weight_spectral,
  weight_biological,
  score_biological_domain,
  score_biological_kingdom,
  score_biological_phylum,
  score_biological_class,
  score_biological_order,
  score_biological_family,
  score_biological_tribe,
  score_biological_genus,
  score_biological_species,
  score_biological_variety
)
}
\arguments{
\item{annotation_table_taxed}{Data frame with initial annotations and sample taxonomy}

\item{structure_organism_pairs_table}{Data frame with structure-organism pairs and taxonomies}

\item{weight_spectral}{Weight for spectral similarity score (any positive number)}

\item{weight_biological}{Weight for biological source score (any positive number)}

\item{score_biological_domain}{Score for domain-level taxonomic match (0-1)}

\item{score_biological_kingdom}{Score for kingdom-level match (0-1)}

\item{score_biological_phylum}{Score for phylum-level match (0-1)}

\item{score_biological_class}{Score for class-level match (0-1)}

\item{score_biological_order}{Score for order-level match (0-1)}

\item{score_biological_family}{Score for family-level match (0-1)}

\item{score_biological_tribe}{Score for tribe-level match (0-1)}

\item{score_biological_genus}{Score for genus-level match (0-1)}

\item{score_biological_species}{Score for species-level match (0-1)}

\item{score_biological_variety}{Score for variety-level match (0-1, highest)}
}
\value{
Data frame with biologically weighted annotations including biological
scores and combined weighted scores
}
\description{
Weights MS annotations according to their biological source by
comparing the taxonomic hierarchy of candidate structures' reported
organisms with the sample's organism taxonomy. Higher taxonomic
similarity results in higher biological scores.
}
\details{
The weights are automatically normalized by dividing by their sum,
so they do NOT need to sum to 1. For example, weights of (1, 1) produce
the same result as (0.5, 0.5).
}
\examples{
\dontrun{
# Weights are automatically normalized - these are equivalent:
# (1, 1) gives same result as (0.5, 0.5)
weighted <- weight_bio(
  annotation_table_taxed = annotations,
  structure_organism_pairs_table = sop_table,
  weight_spectral = 1,      # Will be normalized to 0.5
  weight_biological = 1,    # Will be normalized to 0.5
  score_biological_domain = 0.01,
  score_biological_kingdom = 0.02,
  score_biological_phylum = 0.05,
  score_biological_class = 0.1,
  score_biological_order = 0.2,
  score_biological_family = 0.3,
  score_biological_tribe = 0.5,
  score_biological_genus = 0.7,
  score_biological_species = 0.9,
  score_biological_variety = 1.0
)
}
}
