% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clean_chemo.R
\name{clean_chemo}
\alias{clean_chemo}
\title{Clean Chemical Annotations}
\usage{
clean_chemo(
  annot_table_wei_chemo = get("annot_table_wei_chemo", envir = parent.frame()),
  components_table = get("components_table", envir = parent.frame()),
  features_table = get("features_table", envir = parent.frame()),
  structure_organism_pairs_table = get("structure_organism_pairs_table", envir =
    parent.frame()),
  candidates_final = get("candidates_final", envir = parent.frame()),
  best_percentile = get("best_percentile", envir = parent.frame()),
  minimal_ms1_bio = get("minimal_ms1_bio", envir = parent.frame()),
  minimal_ms1_chemo = get("minimal_ms1_chemo", envir = parent.frame()),
  minimal_ms1_condition = get("minimal_ms1_condition", envir = parent.frame()),
  compounds_names = get("compounds_names", envir = parent.frame()),
  high_confidence = get("high_confidence", envir = parent.frame()),
  remove_ties = get("remove_ties", envir = parent.frame()),
  summarize = get("summarize", envir = parent.frame())
)
}
\arguments{
\item{annot_table_wei_chemo}{Data frame with chemically weighted annotations.
Required columns: feature_id, candidate_structure_inchikey_connectivity_layer,
score_weighted_chemo, score_biological, score_chemical, candidate_score_pseudo_initial}

\item{components_table}{Data frame with molecular network component assignments.
Required columns: feature_id, component_id}

\item{features_table}{Data frame with feature metadata (RT, m/z, etc.).
Required columns: feature_id}

\item{structure_organism_pairs_table}{Data frame linking structures to organisms.
Required columns: structure_inchikey_connectivity_layer}

\item{candidates_final}{Integer, number of top candidates to retain per feature (>= 1)}

\item{best_percentile}{Numeric (0-1), percentile threshold for score filtering.
Candidates with scores >= percentile * max_score are kept. Default: 0.9 (90th percentile)}

\item{minimal_ms1_bio}{Numeric (0-1), minimum biological score for MS1-only annotations}

\item{minimal_ms1_chemo}{Numeric (0-1), minimum chemical score for MS1-only annotations}

\item{minimal_ms1_condition}{Character, logical operator for MS1 filtering: "OR" or "AND".
"OR" = keep if bio >= threshold OR chem >= threshold.
"AND" = keep if bio >= threshold AND chem >= threshold}

\item{compounds_names}{Logical, include compound names in output (may increase size)}

\item{high_confidence}{Logical, apply strict high-confidence filters}

\item{remove_ties}{Logical, remove tied scores (keep only highest-ranked)}

\item{summarize}{Logical, collapse results to one row per feature}
}
\value{
Named list with three data frames:
\describe{
\item{full}{All annotations (optionally high-confidence filtered)}
\item{filtered}{Top candidates meeting percentile + rank thresholds}
\item{mini}{One row per feature with best compound/taxonomy}
}
}
\description{
Cleans and filters chemically weighted annotation results through
a multi-tier pipeline. Applies MS1 score thresholds, percentile filtering,
ranking, and optional high-confidence filtering. Returns three-tier output:
full (comprehensive), filtered (top candidates), and mini (one row per feature).
}
\examples{
\dontrun{
results <- clean_chemo(
  annot_table_wei_chemo = annotations,
  features_table = features,
  components_table = components,
  structure_organism_pairs_table = sop_table,
  candidates_final = 10,
  best_percentile = 0.9,
  minimal_ms1_bio = 0.5,
  minimal_ms1_chemo = 0.5,
  minimal_ms1_condition = "OR",
  compounds_names = TRUE,
  high_confidence = FALSE,
  remove_ties = FALSE,
  summarize = FALSE
)
}
}
\seealso{
\code{\link{weight_chemo}}, \code{\link{filter_high_confidence_only}},
\code{\link{summarize_results}}
}
